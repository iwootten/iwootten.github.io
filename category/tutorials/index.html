<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Ian Wootten - Web Developer, Cardiff</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/fonts/open-sans.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-263865-2', 'ianwootten.co.uk');
      ga('send', 'pageview');

    </script>
</head>
<body>

<div class="container blog">
    <header>
      <nav>
      <ul class="nav">
        <li><a class="blog active" href="/">Blog</a></li>
        <li><a class="javascript " href="/category/javascript">Javascript</a></li>
        <li><a class="web-apps " href="/category/web-apps">Web Apps</a></li>
        <li><a class="about" href="/about">About</a></li>
        <li><a class="contact" href="/contact">Contact</a></li>
      </ul>
      </nav>
      <div class="clear"></div>
    </header>

      
        <div class="post">
          <h1><a href="/2013/10/27/setting-up-an-is-domain-with-isnic">Setting Up an .is Domain with ISNIC</a></h1>
      <div class="author_meta">27 Oct 2013</div>

          <p>I&#8217;ve purchased a couple of .is straight from the Icelandic Domain Registry (ISNIC) in the past year with a view to using them with my own vps. The process of setting up nameservers isn&#8217;t great, given their somewhat confusing management interface. That&#8217;s summed up in a recent tweet below.</p>
<p><blockquote class="twitter-tweet" lang="en"><p>Looks like I just spent 39 euros on a domain I canâ€™t use. Fucksticks.</p>&mdash; Craig Lockwood (@craiginwales) <a href="https://twitter.com/craiginwales/statuses/394167434196058112">October 26, 2013</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Given the potential savings compared to a &#8216;normal&#8217; registrar, it&#8217;s likely you&#8217;ll want to make use of ISNIC themselves &#8211; who are much like an Icelandic version of Nominet.</p>
<p>Here&#8217;s the process I went through to configure my domain to make use of the nameservers provided by my (non-icelandic) host. The information provided <a href="http://web.peterhartree.co.uk/2012/how-to-register-an-icelandic-is-domain-name/">here</a> is a little misleading as it&#8217;s not necessary to use a &#8220;pre-approved&#8221; registrar according to the rules outlined <a href="https://www.isnic.is/en/host/req">here</a>. To be clear, there&#8217;s no need to use something like x.is, and you can point ISNIC directly to your hosts nameservers.</p>
<p>Once you&#8217;ve gone through the process of checking your domain is available and registering it, you&#8217;ll need to ensure your hosting provider has appropriate dns entries for your domain. If you&#8217;re using, cPanel or something that basically means adding it there. If you&#8217;re managing your own dns entries, add the appropriate entries within your manager.</p>
<p>Here&#8217;s the key bit. Now wait&#8230;. Seriously, for about 6 hours or so do something else. It will take some time for these dns changes to propagate and ISNIC to accept them. Basically these details need to be bounced up through the hierarchy of dns servers to the root dns servers that will respond to a request for your new domain, which takes time. In the olden days, I remember waiting days for this to happen.</p>
<p>Following that wait, head to the &#8220;redelegate&#8221; option within your new &#8220;My Page&#8221; area at ISNIC. Choose the &#8220;Not Registered&#8221; when asked for your ISP.</p>
<p>Go ahead and enter the nameservers you want to use. If the dns changes haven&#8217;t yet propagated, you&#8217;ll probably get the error &#8220;The nameserver &#8216;ns1.whatever.com&#8217; has not been registered&#8221;, as shown below:</p>
<p><a href="http://www.ianwootten.co.uk/wp-content/uploads/2013/10/Screen-Shot-2013-10-26-at-23.57.26.png"><img src="http://www.ianwootten.co.uk/wp-content/uploads/2013/10/Screen-Shot-2013-10-26-at-23.57.26.png" alt="Misleading Error" width="676" height="360" class="alignnone size-full wp-image-912" /></a></p>
<p>This is a pretty misleading error, given what it actually means is &#8220;your domain doesn&#8217;t seem to be registered yet on those nameservers&#8221;. So wait a bit more for propagation to occur&#8230;</p>
<p>Be aware of the <a href="https://www.isnic.is/en/host/req">rules</a> for ISNIC nameservers and check your host complies with them, otherwise you may find you encounter other errors. When the changes are picked up, you should finally be able to add the entries without getting an array of red boxes, much like below.</p>
<p><a href="http://www.ianwootten.co.uk/wp-content/uploads/2013/10/Screen-Shot-2013-10-26-at-20.05.05.png"><img src="http://www.ianwootten.co.uk/wp-content/uploads/2013/10/Screen-Shot-2013-10-26-at-20.05.05.png" alt="Successful nameserver entry" width="684" height="577" class="alignnone size-full wp-image-913" /></a></p>


          <div class="entry_content">Tagged
              
                
                <a href="/tag/dns">dns</a>,
                
                <a href="/tag/hosting">hosting</a>,
                
                <a href="/tag/iceland">iceland</a>,
                
                <a href="/tag/nameservers">nameservers</a>,
                
              
              | <a href="2013/10/27/setting-up-an-is-domain-with-isnic/#disqus_thread">Leave a comment</a>
          </div>
        </div>
      
        <div class="post">
          <h1><a href="/2012/09/04/recovering-images-from-sd-cards-with-photorec">Recovering Images from SD Cards with PhotoRec</a></h1>
      <div class="author_meta">04 Sep 2012</div>

          <p>I had the horrible situation last Sunday following removing a number of pictures using an SD reader from my SD card that when I inserted it in my camera, it registered nothing upon it. My heart sunk, because this card is stuffed full of images of me and my family (along with my 1 year old son growing up) and I was unsure of which ones I&#8217;d actually backed up. After perusing the hidden files on the card, all I could discover was the files I&#8217;d most recently transferred from the card&#8230;.great&#8230;</p>
<p>Partly this was my own fault &#8211; I&#8217;d already experienced problems with the reader in question when trying to write images for my <a href="http://raspberrypi.org">Raspberry Pi</a> and shouldn&#8217;t have used it for transferring images I care about. The card in question is a uber cheapo <a href="http://www.amazon.co.uk/Integral-USB-Single-Slot-Reader/dp/B000VY80AM/ref=sr_1_1?ie=UTF8&#038;qid=1346533453&#038;sr=8-1">Integral USB 2.0</a>. Despite what the amazon reviews say, steer well clear of it &#8211; this has been a pain from day one, with intermittent transfer problems which triggered this situation.</p>
<p>After a little more digging, I came across <a href="http://www.cgsecurity.org/wiki/PhotoRec">Photorec</a>, a commandline utility which seemed like it would hopefully help recover some of the images. I attempted to use it with my card reader, but given it&#8217;s credentials I&#8217;ve given above, found the scanning process would cut out and couldn&#8217;t get through the whole card. At this point the card was being reported empty&#8230;.great&#8230;Given the way PhotoRec works, I understood it would still be possible to extract the images despite this. I decided to order another reader and hold fire until it had arrived &#8211; this time I opted for a <a href="http://www.amazon.co.uk/Kingston-Technology-Multi-Card-Reader/dp/B007PFQ0PC/">Kingston USB 3.0</a> (which I haven&#8217;t had any such problems with so far).</p>
<h2 id="the-solution">The Solution</h2>
<p>Here are the steps I followed after receiving my new sd reader to recover images from the card using PhotoRec. I&#8217;m listing them for anyone else who may have the same horrendous stomach wrenching problem I did last Sunday. It seems to have worked pretty well, with only 1 movie file coming out corrupted and about 500 images recovered.</p>
<p>Firstly, I wanted to take a copy of the card as it currently stood following my investigation. For this I used df, diskutil and ddrescue.</p>
<p>To determine where the card is currently mounted (look for the one that&#8217;s about the right size):</p>
<div class='hljs'><pre><code class='bash'>df -h</code></pre></div><p>To unmount the card so we can fiddle with it:</p>
<div class='hljs'><pre><code class='bash'>sudo diskutil unmount /dev/disk1s1</code></pre></div><p>To backup the card to a disk image on your macbook:</p>
<div class='hljs'><pre><code class='bash'>sudo ddrescue /dev/disk1s1 ./sdbackup/image.img backuplog</code></pre></div><p>Finally, using PhotoRec scan the disk image that was just created. My image was FAT formatted I scanned the whole thing rather than just unallocated blocks.</p>
<div class='hljs'><pre><code class='bash'>sudo ./photorec ~/sdbackup/image.img</code></pre></div><p>The final piece of this saga was to rename all the files PhotoRec created so they were in folders according to their exif data. My photos are all in folders like &#8220;2012_06_30&#8243;, so to have 500 files named &#8220;f0677440.jpg&#8221;, &#8220;f0688768.jpg&#8221; in a random PhotoRec directory would be pretty annoying. I had looked at setting up an automator task for this, but I ended up using <a href="http://www.petrosit.de/index.php/apps/12-pexiftool">PexifTool</a> for simplicities sake (I&#8217;m sure there are other alternatives). I believe if you go the Automator route, you may well have to install plugins in order to be able to extract exif data from files.</p>


          <div class="entry_content">Tagged
              
                
                <a href="/tag/linux">linux</a>,
                
                <a href="/tag/mac">mac</a>,
                
                <a href="/tag/photorec">photorec</a>,
                
              
              | <a href="2012/09/04/recovering-images-from-sd-cards-with-photorec/#disqus_thread">Leave a comment</a>
          </div>
        </div>
      
        <div class="post">
          <h1><a href="/2012/03/01/how-to-switch-your-vps-in-2-hours">How to Switch Your VPS in 2 Hours</a></h1>
      <div class="author_meta">01 Mar 2012</div>

          <p>Friday last week I woke up to a barrage of emails coming into my inbox. All of these were coming from notification of spam comments upon this very blog. By the time Iâ€™d woken up Iâ€™d had something like 75 emails. This was pretty strange given that Akismet was there guarding my blog ever since itâ€™s been available and Iâ€™d never had a email about a dodgy comment since Iâ€™d set it up (something like 5 years ago). They continued to flood in during my breakfast as fast as I could delete them.</p>
<p>The problem stemmed from the fact that network connectivity from my slicehost account had been knocked out of action &#8211; which had never happened before. I presumed this was down to the migration of slicehost over to Rackspace infrastructure, which Iâ€™d been informed of, but the network dying was probably unintended.</p>
<p>Either way, it was frustrating and I instantly decided to finally migrate away from slicehost and setup a second linode account. The funny thing is, that most of this was aided by slicehosts own documentation on configuring your server. If youâ€™re doing little more than hosting a number of mysql / php driven sites, it is in fact really simple to switch. Hereâ€™s how I went about it, my sites all experience fairly low traffic, so Iâ€™m aware this solution might not be right for everyone.</p>
<h2 id="backup-all-your-important-data">Backup All Your Important Data</h2>
<p>First of all, youâ€™re going to need to backup everything you have in your sites directory. For me, thatâ€™s everything under /var/www.</p>
<div class='hljs'><pre><code class='bash'>tar -zcvf backup-feb-2012.tar.gz /var/www</code></pre></div><p>Next, youâ€™ll want to do the same for your Apache sites:</p>
<div class='hljs'><pre><code class='bash'>tar -zcvf backup-apache-feb-2012.tar.gz /etc/apache2/sites-available</code></pre></div><p>Finally, I took a mysqldump of my entire mysql setup:</p>
<div class='hljs'><pre><code class='bash'>mysqldump --all-databases -u root -p password | gzip &gt;dbbackup-feb-2012.sql.gz</code></pre></div><h2 id="setup-your-new-vps">Setup Your New VPS</h2>
<p>Having done that, you have pretty much everything you need to bring your server back to life as it is now. Go and grab a new vps from linode or somewhere else and set it up using the details starting from here: <a href="http://articles.slicehost.com/2010/10/18/ubuntu-maverick-setup-part-1">http://articles.slicehost.com/2010/10/18/ubuntu-maverick-setup-part-1</a> I configured my vps to have exactly the same accounts and passwords as my original vps, to make life easier for me. Once SSH and your firewall has been setup and youâ€™re all updated, youâ€™ll be able to transfer all the files you just created onto your fresh vps setup, using filezilla, or a direct connection between the two machines. Youâ€™ll then need to install Apache: <a href="http://articles.slicehost.com/2010/5/19/installing-apache-on-ubuntu">http://articles.slicehost.com/2010/5/19/installing-apache-on-ubuntu</a>, PHP: <a href="http://articles.slicehost.com/2010/5/19/installing-php-on-ubuntu">http://articles.slicehost.com/2010/5/19/installing-php-on-ubuntu</a> and MySQL: <a href="http://articles.slicehost.com/2011/3/10/installing-mysql-server-on-ubuntu">http://articles.slicehost.com/2011/3/10/installing-mysql-server-on-ubuntu</a></p>
<p>On your new machine, youâ€™ll need to restore the files you backed up to /var/www.</p>
<div class='hljs'><pre><code class='bash'>tar -xzf backup-feb-2012.tar.gz
sudo cp -r var/www/* /var/www/
sudo chown -R www-data:www-data /var/www/*
rm -rf ~/var</code></pre></div><p>Then the apache site files:</p>
<div class='hljs'><pre><code class='bash'>tar -xzf backup-apache-feb-2012.tar.gz
sudo cp etc/apache2/sites-available/* /etc/apache2/sites-available/</code></pre></div><p>For every file that exists in the sites directory and is to be enabled, we need to enable it. You can use a2ensite for this if you like.</p>
<div class='hljs'><pre><code class='bash'><span class="hljs-built_in">cd</span> /etc/apache2/sites-enabled
sudo ln <span class="hljs-operator">-s</span> ../sites-available/ianwootten.co.uk.conf ianwootten.co.uk.conf (<span class="hljs-keyword">for</span> each site file)</code></pre></div><p>Install any apache modules you might require and restart apache. If youâ€™re using wordpress or a php framework like me, youâ€™ll most likely need mod_rewrite.</p>
<div class='hljs'><pre><code class='bash'>sudo a2enmod rewrite
sudo /etc/init.d/apache2 restart</code></pre></div><p>Youâ€™ll then need to repopulate your new mysql install with all your old data.</p>
<div class='hljs'><pre><code class='bash'>gunzip -c databasebackup.sql.gz | mysql -u root -p</code></pre></div><h2 id="configure-email">Configure Email</h2>
<p>I use msmtp to handle all my email on my server, which sends through a single gmail automailer address for my domain. If you want to send email that way do the following:</p>
<div class='hljs'><pre><code class='bash'>sudo apt-get install msmtp ca-certificates
sudo nano /etc/msmtprc</code></pre></div><p>Paste the following setup in the file:</p>
<p>`defaults<br />
tls             on<br />
tls_starttls    on<br />
tls_trust_file  /etc/ssl/certs/ca-certificates.crt</p></p>
<p><p>account default<br />
host            smtp.gmail.com<br />
port            587<br />
auto_from       off<br />
auth            on<br />
user            automailer@somedomain.com<br />
password        mymailpass<br />
from            automailer@somedomain.com<br />
maildomain      somedomain.com<br />
logfile        /var/log/msmtp.log`</p>
<div class='hljs'><pre><code class='bash'>sudo chmod 0644 /etc/msmtprc</code></pre></div><p>You can test whether itâ€™s working using a the command as:</p>
<div class='hljs'><pre><code class='bash'><span class="hljs-built_in">echo</span> <span class="hljs-operator">-e</span> <span class="hljs-string">"Subject: A Test Email\r\n\r\nThis is a test"</span> |msmtp --debug --from=default -t mymail@gmail.com</code></pre></div><h2 id="configure-dns">Configure DNS</h2>
<p>You need to configure how your vps is going to handle particular requests for various domains. Youâ€™ve probably had to do this already with your current vps, so just copy the entries through whatever management system your new host provides. For sites that have a fairly simple setup, your host may provide a simple set of default entries to use, or you can clone entries that have the same setup as each other.</p>
<p>Weâ€™re now at the point where we have a complete copy of our vps up and running, and the vps knows how to handle requests for domains, however currently our domain registrar points to our old vps, so the requests will never reach our new server. Head to your domain registrar and change the entries for a single domain, to point to your new vps (ns1.linode.com, ns2.linode.com etc). Now sit and wait patientlyâ€¦.Once that domain has propagated correctly (ping it to see if has a new or old ip), and youâ€™re happy your site is working as expected, go ahead and change all of your domains dns entries to the ip address of your new vps.</p>
<h2 id="relax-8230-">Relax&#8230;</h2>
<p>All in all, I don&#8217;t think this took me more than a couple of hours working with the terminal open. I certainly didn&#8217;t worry about migrating in the way I have done previously. As I opted for a uk datacentre with linode, a side effect of the change is all my sites are much much faster &#8211; and a better setup with linode is in fact cheaper than slicehost. I left my slicehost account running for an entire week prior to shutting it down yesterday &#8211; just in case&#8230;</p>


          <div class="entry_content">Tagged
              
                
                <a href="/tag/dns">dns</a>,
                
                <a href="/tag/gmail">gmail</a>,
                
                <a href="/tag/linode">linode</a>,
                
                <a href="/tag/msmtp">msmtp</a>,
                
                <a href="/tag/server">server</a>,
                
                <a href="/tag/slicehost">slicehost</a>,
                
              
              | <a href="2012/03/01/how-to-switch-your-vps-in-2-hours/#disqus_thread">Leave a comment</a>
          </div>
        </div>
      
        <div class="post">
          <h1><a href="/2011/09/09/hosting-an-octopress-blog-on-amazon-s3">Hosting an Octopress Blog on Amazon S3</a></h1>
      <div class="author_meta">09 Sep 2011</div>

          <p><a href="http://octopress.org">Octopress</a> is a framework for blogging based on the static site generator <a href="https://github.com/mojombo/jekyll">jekyll</a>. In short jekyll takes markdown and turns it into blog style html ready to be served straight away with Apache whilst Octopress dresses it up nicely with HTML5, responsive layout goodness and gives you a bunch of options for code formatting and the like. A perfect little blogging setup for hackers for those of us who typically won&#8217;t need all the bells and whistles on our blog I&#8217;m sure you&#8217;ll agree.</p>
<p>Using Octopress, you&#8217;d typically write your posts in markdown and process them locally. You&#8217;d then have a number of HTML pages to upload to your web server, which would appear no different than any other blog in terms of functionality.</p>
<p>The most interesting thing that coincincides with the creation of jekyll is that it is now possible to serve static websites straight from Amazon S3, meaning that it isn&#8217;t neccessary to have a web server to serve a Octopress blog. I&#8217;ve been playing a little and have been able to serve my own octopress blog which you can see over at <a href="http://www.ianwootten.com">www.ianwootten.com</a>. Here&#8217;s how to do it:</p>
<h2 id="configure-an-s3-bucket-to-act-as-a-website">Configure an S3 Bucket to Act as a Website</h2>
<p>NB: If you want to use your own domain, then you&#8217;re going to need to create an S3 bucket from the AWS Console named the same as your domain (so for me I created a bucket called &#8220;www.ianwootten.com&#8221;. </p>
<p>To configure your bucket as a website, from the AWS Console, select the new bucket and click &#8220;Properties&#8221;. Choose the &#8220;Website&#8221; tab from the box that appears and check &#8220;enabled&#8221; and set the Index document as &#8220;index.html&#8221;. Click &#8220;Save&#8221;. Now move to the &#8220;permissions&#8221; tab and click &#8220;Add bucket policy&#8221;. Enter a policy as below, with &#8220;www.ianwootten.com&#8221; replaced with the name of the bucket you&#8217;re using.</p>
<p><code>&lt;br /&gt;
{&lt;br /&gt;
    &quot;Version&quot;: &quot;2008-10-17&quot;,&lt;br /&gt;
    &quot;Id&quot;: &quot;&quot;,&lt;br /&gt;
    &quot;Statement&quot;: [&lt;br /&gt;
        {&lt;br /&gt;
            &quot;Sid&quot;: &quot;PublicReadForGetBucketObjects&quot;,&lt;br /&gt;
            &quot;Effect&quot;: &quot;Allow&quot;,&lt;br /&gt;
            &quot;Principal&quot;: {&lt;br /&gt;
                &quot;AWS&quot;: &quot;*&quot;&lt;br /&gt;
            },&lt;br /&gt;
            &quot;Action&quot;: &quot;s3:GetObject&quot;,&lt;br /&gt;
            &quot;Resource&quot;: &quot;arn:aws:s3:::www.ianwootten.com/*&quot;&lt;br /&gt;
        }&lt;br /&gt;
    ]&lt;br /&gt;
}&lt;br /&gt;</code></p>
<p>If you&#8217;ve opted not to use your own domain, then that&#8217;s it for S3. Your new bucket website will be available at a combination of the bucket name and the S3 storage location. In my case, this is <a href="http://www.ianwootten.com.s3-website-us-east-1.amazonaws.com/">http://www.ianwootten.com.s3-website-us-east-1.amazonaws.com/</a>. There&#8217;s a list of endpoints on the &#8220;website endpoints&#8221; page in <a href="http://docs.amazonwebservices.com/AmazonS3/latest/dev/index.html?WebsiteHosting.html">Amazons S3 website docs</a>.</p>
<h2 id="configure-dns">Configure DNS</h2>
<p>If you&#8217;re wanting to use your own domain, then you&#8217;ll need to visit your domain registraar and edit some DNS entries. In my case, I added a CNAME entry &#8220;www&#8221; pointing to www.ianwootten.com.s3-website-us-east-1.amazonaws.com. You&#8217;ll need to use a tool like <a href="http://wwwizer.com">wwwizer</a> in order to forward from the root of your domain to the www subdomain. e.g. &#8220;ianwootten.com&#8221; to &#8220;www.ianwootten.com&#8221;. To get that working, you&#8217;ll also need to modify the @ A record and point it to 174.129.25.170. Read this <a href="http://serverfault.com/questions/62527/how-to-create-a-cname-for-a-domains-root-name">serverfault post</a> if you&#8217;re interested to know why.</p>
<p>For more info on CNAME configuration and S3 see <a href="http://docs.amazonwebservices.com/AmazonS3/latest/dev/index.html?WebsiteHosting.html">Amazons S3 website docs</a> (Specifically the notes on virtual hosting).</p>
<h2 id="download-octopress-and-write-some-markdown">Download Octopress and write some Markdown</h2>
<p>Having successfully configured Amazon S3 to host your blog, you need to tackle the age old problem of writing some content for it. This was particularly hard for me, given my lack of knowledge about markdown! You may like to take a look at <a href="http://daringfireball.net/projects/markdown/basics">John Grubers explanation of markdown</a> if you&#8217;re suffering like me. The <a href="http://octopress.org/docs/blogging/">Octopress blogging basics</a> gives a good overview of how your new local blogging workflow will work. Essentially new posts are written in the ./_source/posts folder and when <code>rake generate</code> is executed, your entire websites content is output to the ./public folder. You can also run <code>rake preview</code> in order to preview on a local server.</p>
<p>TO publish your blog, it&#8217;s merely a matter of transferring your /public content to the S3 bucket you&#8217;ve generated.</p>
<p>Having done all that you&#8217;ve now no need to run your own server. You&#8217;re still dependent on those that operate at S3, wwwizer and your domain registraar, but you&#8217;ve removed your own from the equation. You may be interested in checking out <a href="http://www.jerome-bernard.com/blog/2011/08/20/quick-tip-for-easily-deploying-octopress-blog-on-amazon-s3/">Jerome Bernard&#8217;s</a> tip on easily deploying Octopress blogs with <a href="http://s3tools.org/s3cmd">s3cmd</a>.</p>


          <div class="entry_content">Tagged
              
                
                <a href="/tag/amazon">amazon</a>,
                
                <a href="/tag/blog">blog</a>,
                
                <a href="/tag/blogging">blogging</a>,
                
                <a href="/tag/godaddy">godaddy</a>,
                
                <a href="/tag/jekyll">jekyll</a>,
                
                <a href="/tag/octopress">octopress</a>,
                
                <a href="/tag/s3">s3</a>,
                
              
              | <a href="2011/09/09/hosting-an-octopress-blog-on-amazon-s3/#disqus_thread">Leave a comment</a>
          </div>
        </div>
      
        <div class="post">
          <h1><a href="/2010/09/09/installing-gphoto-on-snow-leopard">Installing gPhoto on Snow Leopard</a></h1>
      <div class="author_meta">09 Sep 2010</div>

          <p>I always seem to choose the difficult route to do things. Having become equipped with a new canon camera, I&#8217;m instantly wanting to capture stop motion shorts with it. Unfortunately canons proprietry capture software isn&#8217;t really up to the job and FrameByFrame doesn&#8217;t work with such high-end cameras.</p>
<p>So, I got to thinking wether there was any other route? I was aware of the <a href="http://www.gphoto.org/">gPhoto</a> commandline interface and libgphoto pointed out by a <a href="http://www.txm.net/">colleague</a> some time ago, so I thought I&#8217;d see what I might be able to do with it.</p>
<p>It is possible to install gPhoto using macports, but I chose to compile from source. Here&#8217;s how to do it if anyone else is interested.</p>
<p>Install <a href="http://sourceforge.net/project/showfiles.php?group_id=1674&#038;package_id=277626">libusb</a> <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>Install <a href="http://sourceforge.net/project/showfiles.php?group_id=1674&#038;package_id=277627">libusb compat</a> <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure <span style="color: #007800;">LIBUSB_1_0_CFLAGS</span>=-I<span style="color: #000000; font-weight: bold;">/</span>usr<span style="color: #000000; font-weight: bold;">/</span>local<span style="color: #000000; font-weight: bold;">/</span>include<span style="color: #000000; font-weight: bold;">/</span>libusb-<span style="color: #000000;">1.0</span> <span style="color: #007800;">LIBUSB_1_0_LIBS</span>=<span style="color: #ff0000;">&quot;-L/usr/local/lib -lusb-1.0&quot;</span>
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>Install <a href="http://sourceforge.net/projects/libexif/files/">libexif</a> <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>Install &lt;a href=<a href="http://www-rocq.inria.fr/~gilbert/modulopt/libopt/libopt.tgz&quot;&gt;libopt">http://www-rocq.inria.fr/~gilbert/modulopt/libopt/libopt.tgz&quot;&gt;libopt</a></a> <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>Install <a href="http://sourceforge.net/projects/gphoto/files/">libgphoto2</a> (it may not be neccessary to restrict to a subset of drivers as I have done here, but on my macbook it wouldn&#8217;t compile unless I did so.) <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure <span style="color: #660033;">--with-drivers</span>=canon
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>Install <a href="http://tiswww.case.edu/php/chet/readline/rltop.html">readline</a> <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>Install <a href="http://sourceforge.net/projects/gphoto/files/">gphoto</a> <div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>configure
<span style="color: #c20cb9; font-weight: bold;">make</span>
<span style="color: #c20cb9; font-weight: bold;">sudo</span> <span style="color: #c20cb9; font-weight: bold;">make</span> <span style="color: #c20cb9; font-weight: bold;">install</span></pre>
      </td>
    </tr>
  </table>
</div></p>
<p>You now should be able to capture, download, setup timelapses all from your terminal. See the <a href="http://www.gphoto.org/doc/manual/using-gphoto2.html">full list of examples</a> on the <a href="http://www.gphoto.org/">gphoto homepage</a>.</p>
<p>In my own experiments, I&#8217;ve found I&#8217;ve mad to kill the PTP software that is initially fired up by the mac in order for gphoto to be able to communicate over usb. It also seems that any files I capture are not written to the memory card (or listed using the &#8211;list-files argument), meaning I need to use the &#8211;capture-image-and-download argument to capture direct to my machine. I&#8217;ve not had much time to experiment yet, so there may be another workaround.</p>
<p>Anyway, its not a stop motion app yet, but it&#8217;s a start!</p>


          <div class="entry_content">Tagged
              
                
                <a href="/tag/camera">camera</a>,
                
                <a href="/tag/code">code</a>,
                
                <a href="/tag/stop-motion">stop motion</a>,
                
              
              | <a href="2010/09/09/installing-gphoto-on-snow-leopard/#disqus_thread">Leave a comment</a>
          </div>
        </div>
      

      <div class="pagination">
          
          <span class="page_number ">Page: 1 of 2</span>

          
          <a href="/category/Tutorials/page/2" class="next">Next</a>
          
      </div>
    <footer>
      <div class="footer-about">
        I'm a Web Developer  working at <a href="http://niftydigits.com">Nifty Digits</a> in Cardiff, UK. Here, I enjoy talking code - mostly javascript. I'm <a href="http://twitter.com/iwootten">@iwootten</a> on twitter.
      </div>
    </footer>
  </div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'ianwootten'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
</body>
</html>

