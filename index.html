<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Ian Wootten - Web Developer, Cardiff</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/fonts/open-sans.css" />
        <link rel="stylesheet" href="/css/style.css" />
        <link rel="stylesheet" href="/css/syntax.css" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-263865-2', 'ianwootten.co.uk');
      ga('send', 'pageview');

    </script>
    </head>
    <body>


    <div class="container blog">
      <header>
        <nav>
        <ul class="nav">
          <li><a class="blog active" href="/">Blog</a></li>
          <li><a class="javascript" href="/category/javascript">Javascript</a></li>
          <li><a class="web-apps" href="/category/web-apps">Web Apps</a></li>
          <li><a class="about" href="/about">About</a></li>
          <li><a class="contact" href="/contact">Contact</a></li>
        </ul>
        </nav>
        <div class="clear"></div>
      </header>

      

<div class="post">
<h1><a href="/2014/07/01/splitting-a-date-range-in-python">Splitting a date range in Python</a></h1>
<div class="author_meta">01 Jul 2014</div>
<p>Dates are one of those annoying things that shouldn’t be, but are regularly difficult in web apps. I used the following two methods in a recent page to neatly break a date range into distinct segments as part of a analytics app I’m currently working on. Hopefully someone else will find them helpful.</p>

<div class="highlight"><pre><code class="python"><span class="kn">import</span> <span class="nn">datetime</span><span class="o">,</span> <span class="nn">calendar</span>

<span class="c"># Find the delta between two dates based on a desired number of ranges</span>
<span class="k">def</span> <span class="nf">datedelta</span><span class="p">(</span><span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">no_of_ranges</span><span class="p">):</span>
    <span class="n">start_epoch</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">startdate</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span>
    <span class="n">end_epoch</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">enddate</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span>

    <span class="n">date_diff</span> <span class="o">=</span> <span class="n">end_epoch</span> <span class="o">-</span> <span class="n">start_epoch</span>

    <span class="n">step</span> <span class="o">=</span> <span class="n">date_diff</span> <span class="o">/</span> <span class="n">no_of_ranges</span>

    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">step</span><span class="p">)</span></code></pre></div>

<p>date_delta allows me to create the timedeltas between two dates based on a desired number of segments.</p>

<div class="highlight"><pre><code class="python"><span class="c"># Edit 18/07/2014 - I realised dates needed the hrs, mins an secs correctly</span>
<span class="c"># adjusted to beginning / end of day</span>
<span class="k">def</span> <span class="nf">datespan</span><span class="p">(</span><span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">currentdate</span> <span class="o">=</span> <span class="n">startdate</span>

    <span class="k">while</span> <span class="n">currentdate</span> <span class="o">+</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">enddate</span><span class="p">:</span>
        <span class="n">todate</span> <span class="o">=</span> <span class="p">(</span><span class="n">currentdate</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">59</span><span class="p">,</span><span class="n">second</span><span class="o">=</span><span class="mi">59</span><span class="p">)</span>

        <span class="k">yield</span> <span class="n">currentdate</span><span class="p">,</span> <span class="n">todate</span>

        <span class="n">currentdate</span> <span class="o">+=</span> <span class="n">delta</span>
        <span class="n">currentdate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code></pre></div>

<p>I can then pass the delta into datespan above, which returns an iterable I can then use.</p>

<div class="highlight"><pre><code class="python"><span class="c"># Get timedeltas based on splitting the range by 10</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">date_delta</span><span class="p">(</span><span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">from_datetime</span><span class="p">,</span> <span class="n">to_datetime</span> <span class="ow">in</span> <span class="n">datespan</span><span class="p">(</span><span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">from_datetime</span><span class="p">,</span> <span class="n">to_datetime</span></code></pre></div>

<p>The result forms part of the following d3 chart:</p>

<blockquote class="twitter-tweet" lang="en"><p>Made some updates to that there commerce dashboard (now uses summary ranges on x-axis), what do people think? <a href="http://t.co/AatFxBRnsC">pic.twitter.com/AatFxBRnsC</a></p>&mdash; Ian Wootten (@iwootten) <a href="https://twitter.com/iwootten/statuses/481780932496863233">June 25, 2014</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>


<div class="entry_content">Tagged <a href="/tag/coding">coding</a>, <a href="/tag/python">python</a>,  | <a href="/2014/07/01/splitting-a-date-range-in-python/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/06/16/tips-for-being-a-more-productive-freelancer">Tips for being a more Productive Freelancer</a></h1>
<div class="author_meta">16 Jun 2014</div>
<p>Having heard the question raised on <a href="http://workingoutpodcast.com">@workingoutshow</a>, I thought I’d take some time to share the things that I’ve found have really helped me be productive in my work. These may not work for everyone, but hopefully some points will help for others.</p>

<h2 id="find-a-good-environment">Find a Good Environment</h2>

<p>The single biggest change I’ve found which has had a major impact on my work is changing my environment. We’re lucky enough to have a small garden at our house and with the arrival of my daughter back in October, I was quick to realise that working in the open plan lounge in our house just wasn’t a viable option any more. Here in Cardiff, we’ve been lucky enough to have several co-working spaces open locally, but for me I prefer being able to switch off background noise and clear my head when I really need to knuckle down and focus. Around the same time, we made some major changes to the back of our house and garden which meant that there was space enough for a desk in our sunroom which overlooks it. I now spend 90% of my working time looking out over our little green space, which makes for a welcome break from staring at my screen and gives me a self-contained and more importantly, quiet environment in which to think. I also get to enjoy the space more overlooking the various wildlife that visits during the day. It’s funny how good a little bird taking a dust bath every now and again will make you feel.</p>

<h2 id="organise-your-tasks">Organise Your Tasks</h2>

<p>I use trello for organising tasks I want to get done, with a board for each project. These are organised in descending priority, using trellos card defaults of “To Do”, “Done” and “Doing” to track what I’ve achieved for a project. If whilst during the course of one task, I realise something needs doing over and above the scope of the task I’m currently working on, I’ll add it to my todo list and work on it when all other tasks with a higher priority have been completed. This strategy works well for me in terms of being able to blast through a whole heap of development tasks without having to think too much about what I need to do next.</p>

<h2 id="plan-your-next-day-before-leaving-your-desk">Plan Your Next Day Before Leaving Your Desk</h2>

<p>I like to end my day at a distinct break between tasks. If my day ends at a point where something is incomplete, I’ll be sure to keep it in my to-do list for the following day, where I can come back to it. Before I leave my desk each day I’ll generally try and plan out what makes sense to cover (given the time I have) in the following working day. This allows me to hit the ground running each day, without any getting up to speed time first thing in the morning.</p>

<h2 id="track-your-time">Track Your Time</h2>

<p>Tracking my time is important not only for my client work, but also my own projects. As well as giving me exact totals for invoicing, it allows me to compare estimates against the reality of a project and all the unforeseen problems that may arise during the course of it. My time tracking is a simple project based on/off approach, where I use a <a href="http://hourglass.io">custom tool</a> I developed myself.</p>

<h2 id="eliminate-distractions">Eliminate Distractions</h2>

<p>Although obvious, trying to cut down on distractions pays dividends. Switch off tweetdeck, close skype and either disable notifications on your phone or (my favourite) put it out of your sight completely. I don’t tend to pay any thought to my phone if I can’t see it, and it’s like a nervous twitch to pick it up and check whether anything has happened in the last 5 mins. When not aware it’s an option, I probably get twice as much work done. It’s easy to kid yourself that checking devices like this is part of your work, but when at the detriment of your day’s schedule you need to switch off and focus on the bigger picture.</p>

<p>These are just a few measures I take to be more productive in my day - I’d welcome any tips other freelancers have for their own situations.</p>


<div class="entry_content">Tagged <a href="/tag/productivity">productivity</a>,  | <a href="/2014/06/16/tips-for-being-a-more-productive-freelancer/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/06/02/porting-a-wordpress-blog-to-jekyll-part-2">Porting a Wordpress blog to Jekyll: Part 2</a></h1>
<div class="author_meta">02 Jun 2014</div>
<p>In the second of my posts in porting a wordpress blog over to jekyll, I outline how I’ve replicated wordpress’s default permalink structure on my own blog.</p>

<h2 id="creating-category-and-tag-pages">Creating Category and Tag Pages</h2>

<p>Jekyll doesn’t create category or tag index pages for those categories listed in your _posts source. Instead, you’ll need to use a plugin to recreate them. I used the tutorial <a href="http://realjenius.com/2012/12/01/jekyll-category-tag-paging-feeds/">here</a> as the basis for my category/tag generator, with my plugins/generate_cats_and_tags.rb source below:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">module</span> <span class="nn">Jekyll</span>
    <span class="k">class</span> <span class="nc">CatsAndTags</span> <span class="o">&lt;</span> <span class="no">Generator</span>
        <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
          <span class="n">site</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">category</span><span class="o">|</span>
            <span class="n">build_subpages</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
          <span class="k">end</span>

          <span class="n">site</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">tag</span><span class="o">|</span>
            <span class="n">build_subpages</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
          <span class="k">end</span>
        <span class="k">end</span>

        <span class="c1"># Do the actual generation.</span>
        <span class="k">def</span> <span class="nf">build_subpages</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
          <span class="n">posts</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">posts</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">sort_by</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="o">-</span><span class="nb">p</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">to_f</span> <span class="p">}</span>
          <span class="n">atomize</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
          <span class="n">paginate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="k">def</span> <span class="nf">atomize</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
          <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/</span><span class="si">#{</span><span class="n">type</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">posts</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span>
          <span class="n">atom</span> <span class="o">=</span> <span class="no">AtomPage</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="n">posts</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
          <span class="n">site</span><span class="o">.</span><span class="n">pages</span> <span class="o">&lt;&lt;</span> <span class="n">atom</span>
        <span class="k">end</span>

        <span class="k">def</span> <span class="nf">paginate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
          <span class="n">pages</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">calculate_pages</span><span class="p">(</span><span class="n">posts</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s1">&#39;paginate&#39;</span><span class="o">].</span><span class="n">to_i</span><span class="p">)</span>
          <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.pages</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">num_page</span><span class="o">|</span>
            <span class="n">pager</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">num_page</span><span class="p">,</span> <span class="n">posts</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
            <span class="n">slug</span> <span class="o">=</span> <span class="n">posts</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">gsub</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">base_path</span> <span class="o">=</span> <span class="s2">&quot;/</span><span class="si">#{</span><span class="n">type</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">slug</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">base_path</span>
            <span class="k">if</span> <span class="n">num_page</span> <span class="o">&gt;</span> <span class="mi">1</span>
              <span class="n">path</span> <span class="o">+=</span> <span class="s2">&quot;/page/</span><span class="si">#{</span><span class="n">num_page</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">end</span>
            <span class="n">newpage</span> <span class="o">=</span> <span class="no">GroupSubPage</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">base_path</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">posts</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span>
            <span class="n">newpage</span><span class="o">.</span><span class="n">pager</span> <span class="o">=</span> <span class="n">pager</span>
            <span class="n">site</span><span class="o">.</span><span class="n">pages</span> <span class="o">&lt;&lt;</span> <span class="n">newpage</span>

          <span class="k">end</span>
        <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">class</span> <span class="nc">GroupSubPage</span> <span class="o">&lt;</span> <span class="no">Page</span>
        <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">base_path</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
          <span class="vi">@site</span> <span class="o">=</span> <span class="n">site</span>
          <span class="vi">@base</span> <span class="o">=</span> <span class="n">base</span>
          <span class="vi">@dir</span> <span class="o">=</span> <span class="n">dir</span>
          <span class="vi">@name</span> <span class="o">=</span> <span class="s1">&#39;index.html&#39;</span>

          <span class="nb">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="vi">@name</span><span class="p">)</span>
          <span class="nb">self</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s1">&#39;_layouts&#39;</span><span class="p">),</span> <span class="s2">&quot;group_index.html&quot;</span><span class="p">)</span>
          <span class="nb">self</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="n">type</span><span class="o">]</span> <span class="o">=</span> <span class="n">val</span>
          <span class="nb">self</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;base&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="n">base_path</span>
        <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">class</span> <span class="nc">AtomPage</span> <span class="o">&lt;</span> <span class="no">Page</span>
        <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
            <span class="vi">@site</span> <span class="o">=</span> <span class="n">site</span>
            <span class="vi">@base</span> <span class="o">=</span> <span class="n">base</span>
            <span class="vi">@dir</span> <span class="o">=</span> <span class="n">dir</span>
            <span class="vi">@name</span> <span class="o">=</span> <span class="s1">&#39;atom.xml&#39;</span>

            <span class="nb">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="vi">@name</span><span class="p">)</span>
            <span class="nb">self</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s1">&#39;_layouts&#39;</span><span class="p">),</span> <span class="s2">&quot;group_atom.xml&quot;</span><span class="p">)</span>
            <span class="nb">self</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="n">type</span><span class="o">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="nb">self</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s2">&quot;grouptype&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">type</span>
            <span class="nb">self</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s2">&quot;posts&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="n">posts</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">9</span><span class="o">]</span>
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>I chose to pass in an extra parameter to the Pager, defining the “base_path” for which an index page has been generated. This enables absolute links to pages and prevents situations like /category/javascript/category/javascript/page/1, which occur when relative pagination is generated when on a category page. </p>

<p>A view making use of it would look like the following:</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;pagination&quot;</span><span class="nt">&gt;</span>
        {% if paginator.previous_page %}
          <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{ page.base }}/page/{{ paginator.previous_page }}&quot;</span> <span class="na">class=</span><span class="s">&quot;previous&quot;</span><span class="nt">&gt;</span>Previous<span class="nt">&lt;/a&gt;</span>
        {% else %}
          <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;previous&quot;</span><span class="nt">&gt;</span>Previous<span class="nt">&lt;/span&gt;</span>
        {% endif %}
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;page_number &quot;</span><span class="nt">&gt;</span>Page: {{ paginator.page }} of {{ paginator.total_pages }}<span class="nt">&lt;/span&gt;</span>
        {% if paginator.next_page %}
          <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{ page.base }}/page/{{ paginator.next_page }}&quot;</span> <span class="na">class=</span><span class="s">&quot;next&quot;</span><span class="nt">&gt;</span>Next<span class="nt">&lt;/a&gt;</span>
        {% else %}
          <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;next &quot;</span><span class="nt">&gt;</span>Next<span class="nt">&lt;/span&gt;</span>
        {% endif %}
<span class="nt">&lt;/div&gt;</span></code></pre></div>

<h2 id="creating-archive-pages">Creating Archive Pages</h2>

<p>In a similar fashion, Jekyll doesn’t create pages or pagination for previous years or months. Even if they are not oft used by others, I find it useful myself to hit up my archives for <a href="http://ianwootten.co.uk/2004">previous years</a> on occasion and <a href="http://www.ianwootten.co.uk/2004/05/06/chicken-breasts/">laugh at the random work I did for my undergraduate</a>.</p>

<p>I created the following plugin to generate indexes at /{year} /{year}/{month} and /{year}/page/{pageNo} and /{year}/{month}/page/{pageNo} if necessary.</p>

<div class="highlight"><pre><code class="ruby"><span class="k">module</span> <span class="nn">Jekyll</span>

  <span class="k">class</span> <span class="nc">ArchiveGenerator</span> <span class="o">&lt;</span> <span class="no">Generator</span>
    <span class="n">safe</span> <span class="kp">true</span>
    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">site</span><span class="o">.</span><span class="n">layouts</span><span class="o">.</span><span class="n">key?</span> <span class="s1">&#39;archive_index&#39;</span>
        <span class="n">site</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">group_by</span><span class="p">{</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span> <span class="p">{</span><span class="s2">&quot;month&quot;</span> <span class="o">=&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span> <span class="o">=&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">}</span> <span class="p">}</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">period</span><span class="p">,</span> <span class="n">posts</span><span class="o">|</span>
          <span class="n">posts</span> <span class="o">=</span> <span class="n">posts</span><span class="o">.</span><span class="n">sort_by</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="o">-</span><span class="nb">p</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">to_f</span> <span class="p">}</span>
          <span class="n">archive_dir</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">period</span><span class="o">[</span><span class="s2">&quot;year&quot;</span><span class="o">].</span><span class="n">to_s</span><span class="p">(),</span> <span class="s2">&quot;%02d&quot;</span> <span class="o">%</span> <span class="n">period</span><span class="o">[</span><span class="s2">&quot;month&quot;</span><span class="o">].</span><span class="n">to_s</span><span class="p">())</span>
          <span class="n">paginate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">archive_dir</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">site</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">group_by</span><span class="p">{</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span> <span class="o">=&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">}</span> <span class="p">}</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">period</span><span class="p">,</span> <span class="n">posts</span><span class="o">|</span>
          <span class="n">posts</span> <span class="o">=</span> <span class="n">posts</span><span class="o">.</span><span class="n">sort_by</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="o">-</span><span class="nb">p</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">to_f</span> <span class="p">}</span>
          <span class="n">archive_dir</span> <span class="o">=</span> <span class="n">period</span><span class="o">[</span><span class="s2">&quot;year&quot;</span><span class="o">].</span><span class="n">to_s</span><span class="p">()</span>
          <span class="n">paginate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">archive_dir</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">paginate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
      <span class="n">pages</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">calculate_pages</span><span class="p">(</span><span class="n">posts</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s1">&#39;paginate&#39;</span><span class="o">].</span><span class="n">to_i</span><span class="p">)</span>
      <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.pages</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">num_page</span><span class="o">|</span>
        <span class="n">pager</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">num_page</span><span class="p">,</span> <span class="n">posts</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
        <span class="n">archive_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">dir</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">archive_path</span>
        <span class="k">if</span> <span class="n">num_page</span> <span class="o">&gt;</span> <span class="mi">1</span>
          <span class="n">path</span> <span class="o">+=</span> <span class="s2">&quot;/page/</span><span class="si">#{</span><span class="n">num_page</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">end</span>
        <span class="n">newpage</span> <span class="o">=</span> <span class="no">ArchiveIndex</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">archive_path</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
        <span class="n">newpage</span><span class="o">.</span><span class="n">pager</span> <span class="o">=</span> <span class="n">pager</span>
        <span class="n">site</span><span class="o">.</span><span class="n">pages</span> <span class="o">&lt;&lt;</span> <span class="n">newpage</span>

      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">class</span> <span class="nc">ArchiveIndex</span> <span class="o">&lt;</span> <span class="no">Page</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">base_path</span><span class="p">,</span> <span class="n">posts</span><span class="p">)</span>
      <span class="vi">@site</span> <span class="o">=</span> <span class="n">site</span>
      <span class="vi">@base</span> <span class="o">=</span> <span class="n">base</span>
      <span class="vi">@dir</span> <span class="o">=</span> <span class="n">dir</span>
      <span class="vi">@name</span> <span class="o">=</span> <span class="s1">&#39;index.html&#39;</span>

      <span class="nb">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="vi">@name</span><span class="p">)</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">read_yaml</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s1">&#39;_layouts&#39;</span><span class="p">),</span> <span class="s1">&#39;archive_index.html&#39;</span><span class="p">)</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">data</span><span class="o">[</span><span class="s1">&#39;base&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="n">base_path</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>The layout of the paginator for the archives is the same as that for categories and tags.</p>

<p>That’s it for my jekyll roundup, I other long time wordpress users find this information useful.</p>

<div class="entry_content">Tagged <a href="/tag/jekyll">jekyll</a>, <a href="/tag/static sites">static sites</a>, <a href="/tag/wordpress">wordpress</a>,  | <a href="/2014/06/02/porting-a-wordpress-blog-to-jekyll-part-2/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/05/20/porting-a-wordpress-blog-to-jekyll-part-1">Porting a Wordpress blog to Jekyll: Part 1</a></h1>
<div class="author_meta">20 May 2014</div>
<p>As my last post indicated, I recently made the decision to leave wordpress for jekyll for my blogging software of choice. There were a number of hurdles I had to overcome in order to get to a state I was happy with, emulating my previous blog structure. This first post details a few of the setup problems and how I’ve overcome them.</p>

<h2 id="using-compass-for-a-jekyll-theme">Using Compass for a Jekyll theme</h2>

<p>The first problem I hit was my use of compass to create parts of the theme I intended to use for my blog. When attempting to use <a href="https://github.com/mscharley/jekyll-compass">jekyll-compass</a> to enable that, I hit the following error:</p>

<div class="highlight"><pre><code class="bash">Unable to activate compass-0.12.6, because sass-3.3.7 conflicts with sass <span class="o">(</span>~&gt; 3.2.19<span class="o">)</span> <span class="o">(</span>Gem::LoadError<span class="o">)</span></code></pre></div>

<p>After searching for a bit I came across the <a href="https://github.com/jekyll/jekyll/issues/2263">following issue</a> which detailed a solution - but unfortunately it didn’t work for me. Being somewhat of a newbie to Ruby, I didn’t realise that after creating a Gem as instructed in the fix, I actually needed to “bundle install” it. After a little more digging and tweaking against <a href="http://twitter.com/markturner">Mark Turners</a> advice, I ended up with a Gem file like so:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">source</span> <span class="s2">&quot;https://rubygems.org&quot;</span>

<span class="n">gem</span> <span class="s1">&#39;sass&#39;</span><span class="p">,</span> <span class="s2">&quot;~&gt; 3.2.19&quot;</span>
<span class="n">gem</span> <span class="s1">&#39;jekyll-compass&#39;</span><span class="p">,</span> <span class="s2">&quot;1.0.6&quot;</span></code></pre></div>

<p>Which has finally given me what I wanted.</p>

<h2 id="using-custom-pygments-themes-for-syntax-highlighting">Using Custom Pygments Themes for Syntax highlighting</h2>

<p>Jekyll uses pygments for fancy pants syntax highlighting. Although an example syntax.css is linked to in the jekyll documentation, I prefer a darker theme myself. Jekyll doesn’t tell you it’s possible to generate any one of the numerous pygments styles like this:</p>

<div class="highlight"><pre><code class="bash">pygmentize -f html -S monokai -a .highlight &gt; monokai.css</code></pre></div>

<p>I’ve used the monokai theme for my own highlighting. There are demos of each of the themes on the pygments site - <a href="http://pygments.org/demo/357593/">here is an example</a>. You can then use that as the basis for your own custom highlighting. I’ve created each one of the 19 possible themes and <a href="https://github.com/iwootten/jekyll-syntax">put them up on github</a>.</p>

<h2 id="moving-to-disqus-commenting">Moving to Disqus Commenting</h2>

<p>Given I now had a static site, I needed a means of continuing supporting comments. Disqus does just that by embedding comments using javascript into post pages. Adding disqus  proved to be the biggest hurdle for me. I had a large number of comments from people on my blog over the years and therefore I didn’t want to lose them. After exporting my site as xml and uploading them to disqus, I finally set jekyll loose on my site along with disqus embeds, but I couldn’t see them. The problem I found after a frustrating hour or two of uploading new versions of my site over ftp, was jekyll used a trailing slash (as the post is an index within a directory) to denote links to posts. It’s possible however to do away with this using .htaccess if you’re using Apache.</p>

<div class="highlight"><pre><code class="apache"><span class="nb">Options</span> -Multiviews +FollowSymLinks
<span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="nb">RewriteBase</span> /
<span class="nb">DirectorySlash</span> <span class="k">Off</span>

<span class="c"># remove the trailing slash</span>
<span class="nb">RewriteRule</span> ^(.*)\/(\?.*)?$ $1$2 [R=301,L]

<span class="c"># rewrite /dir/file to /dir/file/index.html</span>
<span class="nb">RewriteRule</span> ^([\w\/-]+)(\?.*)?$ $1/index.html$2 [L,T=application/x-httpd-html]</code></pre></div>

<p>However, when I began using github pages, this fix didn’t work as github only serves static files and doesn’t allow use of htaccess. Instead, I had to resign to the fact that I would have to have trailing slashes (apparently they’re quicker anyway). This then meant I had to use the Redirect Crawler option of disqus’s “Migrate Threads” wizard (seen below) to crawl my new blog on github and determine where the posts were now located.</p>

<p><img src="http://ianwootten.co.uk/images/screen-2014-05-20.png" title="Disqus Migrate Threads Wizard" /></p>

<p>In my next post I’ll go through how I use plugins to support archive, category and tag pages in jekyll.</p>

<div class="entry_content">Tagged <a href="/tag/jekyll">jekyll</a>, <a href="/tag/static sites">static sites</a>, <a href="/tag/wordpress">wordpress</a>, <a href="/tag/disqus">disqus</a>, <a href="/tag/pygments">pygments</a>,  | <a href="/2014/05/20/porting-a-wordpress-blog-to-jekyll-part-1/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/05/18/bye-bye-wordpress">Bye Bye Wordpress</a></h1>
<div class="author_meta">18 May 2014</div>
<p>I’ve finally made the move to <a href="http://jekyllrb.com">jekyll</a> for building this site. It is now hosted on github pages, comments are handled by disqus and my post source is written in markdown. My entire site is visible <a href="https://github.com/iwootten/iwootten.github.io">on github</a> and revision control for post entries is handled there too.</p>

<p>What finally convinced me with the release of jekyll 2 was the introduction of <a href="http://jekyllrb.com/news/2014/05/06/jekyll-turns-2-0-0/">native sass support</a>. Originally, the prose theme I’m using for my site was using scss, which I later ported to a wordpress theme in order to blog with it. I had the scss for the original design available and therefore thought the jump to using jekyll wouldn’t be that great (or so I thought - overlooking all the features jekyll doesn’t support compared to wordpress). I’m going to blog individually about the pieces of the puzzle in other posts as there are number of things that tripped me up along the way.</p>

<p>But for now, I’d like to bid a fond farewell to wordpress - my go to blogging software for the last 10 years. You once were diminutive, got out of my way and let my voice be heard. That’s no longer the case. These days the only time we speak is when you want me to update you. I’ve got better things to do. Theres a ton of features the length of my arm which I’ve never used and the majority of features which I use rarely. I long for those simpler days once again. You’ve served me well, but I’ve moved on.</p>

<div class="entry_content">Tagged <a href="/tag/jekyll">jekyll</a>, <a href="/tag/static sites">static sites</a>, <a href="/tag/wordpress">wordpress</a>,  | <a href="/2014/05/18/bye-bye-wordpress/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/04/07/copyright-law-finally-aligns-with-me">Copyright Law Finally Aligns with Me</a></h1>
<div class="author_meta">07 Apr 2014</div>
<p>On June 1st 2014, some much needed changes are being made to exceptions to copyright law which amongst other things, will allow conversion of personal media between file formats.</p>

<p>Finally, we’ll able to make personal conversions of digital media (at least they will be now counted as legal copies). I’ve long made copies of my cd’s to listen to whilst coding (iTunes allows me to do so simply) – but it is not currently legal to move these files to another storage medium, such as an mp3 player. The fact is that most people have been ripping cds and copying them to iPods since it was technically possible, but music companies have never prosecuted anyone as the implications would stem far and wide and would the costs would too prohibitive to be able to enforce them.</p>

<p>It’s also not currently legal to rip movies to another format. So copying a dvd to a mkv file to play elsewhere is construed illegal. The fact movie studios put protection in place on their dvds to prevent you from doing so puts most people off doing so anyway. From June 1st this also changes so it will also be legal (but probably will be as difficult due to the copy protection in place). The guidance doesn’t specifically mention blu-rays by name, but it does say “The exception will apply to any copies you have bought, other than computer programs” – which I see to include blu-rays. However, it does also mention that copy protection may still be in place on those formats. Which you can raise a complaint to the secretary of state about if you think it’s too restrictive (good luck getting a response there!).</p>

<p>I’m a big fan of said changes, mainly due to the fact I own a huge amount of discs which aren’t currently allowed to be any format other than that they were distributed in. DVD’s, CD’s and Vinyl(!). I’ve found this frustrating, as my own stance is I should be able to manipulate the media to my hearts content within my own 4 walls. In fact, in order to listen to myself practicing when I used to dj, I need to make recordings which change their format. The fact that I’ll be able to do this within the law makes me a very happy chap indeed. Up until now, the law has been fairly grey on the matter, but hasn’t prosecuted anyone for format conversion (as far as I’m aware).</p>

<p>The new guidance is quick to point out that it’ll still be illegal to distribute the media you create – You have to “own” the media you’re converting. Therefore duplicating a friends mp3 collection at work from their hard drive will still be illegal. If you sell the original format from which you made copies, then your copies will again be illegal. Again this aligns with how I feel things should be done. I feel like I should be paying someone for the entertainment I enjoy from said media. The artist/record labels decide a price and that’s what I should pay – but I don’t feel like they can make me pay multiple times for the same thing, especially if I can create said formats from media I already own. If you hold a copy but haven’t paid for it, I feel it fair for it to be deemed illegal, however possible it is technically to achieve.</p>

<p>In summary, I feel these changes are great (but long overdue). </p>

<p>You can read a full summary of changes to consumers issued by the Intellectual Property Office <a href="http://www.ipo.gov.uk/copyright-guidance-consumers.pdf">here</a>. Amusingly, the document explains you may be affected if you “read books, watch films or listen to music” – or my favourite “use electronic devices”. I guess that covers anyone reading this then.</p>


<div class="entry_content">Tagged <a href="/tag/copyright">copyright</a>, <a href="/tag/law">law</a>, <a href="/tag/Music">Music</a>,  | <a href="/2014/04/07/copyright-law-finally-aligns-with-me/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/03/23/shipping-in-march-weeks-2-3">Shipping in March: Weeks 2 &#038; 3</a></h1>
<div class="author_meta">23 Mar 2014</div>
<p>So, anybody paying close attention may have noticed I’ve skipped a week on updating my progress on <a href="http://www.ianwootten.co.uk/2014/03/03/shipping-in-march">shipping in March</a>. There wasn’t much to report in week 2 aside from I was busily updating my <a href="http://niftydigits.com">Nifty Digits</a> site. This hasn’t yet gone live, mainly due to some restrictions on current client projects and publishing about my previous work. I hope to be able to publish it before the end of the month. I spent approximately 3 days on this, 1 on client work and 1 on working on <a href="http://hourglass.io">Hourglass</a>.</p>

<p>This past week however I’ve been working on a revamp for <a href="http://www.fairandbare.com">Fair &#038; Bare</a> and breaking out the shopping software I built for it into a new product. The reasoning for this is two-fold – we have stock for <a href="http://www.fairandbare.com">Fair &#038; Bare</a> we want to rave about and sell and I spent a long time building a shopping cart system that’s only ever been used by me! It makes sense (at least to me) that making this byproduct available (as per the <a href="https://signalvnoise.com/posts/1620-sell-your-by-products">37signals mantra</a>). <a href="http://www.fairandbare.com">Fair &#038; Bare</a> has existed for 7 years now and it’s backend has barely changed in that time and it’s still happily taking orders. This week has been an opportunity to rebuild it in a more robust manner, with more features and without everything that annoys me about current checkout systems.</p>

<p>Granted, it’s currently small and will probably won’t compare in terms of the number of features to cart provider’s that already exist – but what I hope it will provide is a simple, easy to manage way of selling stuff online. I’ve had a huge amount of thoughts on what would be the best way to package it, but have settled on a SaaS based system, rather than self hosted. I’ve been able to use stripe to simplify the way payments are taken and I’m planning on integrating a number of other tools to make life easier for developers.</p>

<p>Again, it’s incomplete and not ready to release – but it is in a place that I’m able to use it as an admin. I’m planning on getting <a href="http://www.fairandbare.com">F&#038;B</a> using it and then releasing it on it’s own. If you’d like to see some features then please comment below and let me know. </p>

<p>The one thing I have realised about working on my own projects is the freedom I have to talk about it. No NDAs, no worry of treading on people’s toes, just (hopefully) helpful info. Several blog post ideas have been found over the course of the work I’ve been doing so far this month, one of which has already been published. I’m hoping I’ll finally have something to show you all before the end of this week.</p>


<div class="entry_content">Tagged <a href="/tag/ecommerce">ecommerce</a>, <a href="/tag/shopping">shopping</a>, <a href="/tag/time tracking">time tracking</a>,  | <a href="/2014/03/23/shipping-in-march-weeks-2-3/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/03/10/shipping-in-march-week-1">Shipping in March: Week 1</a></h1>
<div class="author_meta">10 Mar 2014</div>
<p>I promised a progress update on how my attempt to get 4 projects shipped this month was going. On my first week, I decided to focus on my time tracking tool, <a href="http://hourglass.io">hourglass</a>. I’ve had this in the works for sometime and unfortunately, it’s fallen by the wayside to client work.</p>

<p>I’ve failed on my first week in getting this released to the world, but I’m far happier with how it’s working now and the value it might give to any potential user than previously. I’d had a working app and a shiny new design for it prior to last week, so first on my agenda was to bring that in and start from there. Beyond that, I bug fixed a number of known issues, followed by building out a number of reporting features which I feel are critical to have before release. It’s also allowed me to better think about the decisions I’ve made regarding implementation and whether or not it makes sense to change them at any stage soon.</p>

<p>Unfortunately, over this time I hit a major hurdle of my internet connection being killed due to scheduled maintenance. I had been sent a letter on this, but hadn’t clocked the date. I was lucky that in Cardiff we have a number of excellent co-working facilities that allow me to turn up unannounced and fled home for the sanctuary of <a href="http://foundershub.co.uk">Foundershub</a>. In the end I lost probably a couple of hours to this problem and I’m glad I made the decision early on to move before I’d lost the best part of the day.</p>

<p>I’m going to be moving on to my next project this week as planned and move back to hourglass if time allows. I feel that experiencing the variety of these projects will hopefully allow me to continue some kind of momentum. Out of all the ones I have planned, I feel that hourglass is probably one of the larger ones too.</p>


<div class="entry_content">Tagged  | <a href="/2014/03/10/shipping-in-march-week-1/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/03/07/scaling-a-linear-domain-to-an-ordinal-range-with-d3">Scaling a Linear Domain to an Ordinal Range with d3</a></h1>
<div class="author_meta">07 Mar 2014</div>
<p>I’ve had the opportunity of using <a href="http://d3js.org/">d3</a> quite a lot over the past few months for a number of clients. It offers some amazing flexibility for chart generation and much more.</p>

<p>Anyway, I thought I’d share a quick tip I developed for mapping a linear set of values onto an ordinal scale. For those who’re seasoned pros at d3, this probably seems trivial, but had me stumped for some time today.</p>

<p>I’d picked out a colour palette I wanted to use for a particular graph, as per below:</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#B8D0DE&quot;</span><span class="p">,</span> <span class="s2">&quot;#9FC2D6&quot;</span><span class="p">,</span> <span class="s2">&quot;#86B4CF&quot;</span><span class="p">,</span> <span class="s2">&quot;#73A2BD&quot;</span><span class="p">,</span> <span class="s2">&quot;#6792AB&quot;</span><span class="p">];</span></code></pre></div>

<p>The only examples I’ve seen similar to this are where it is assumed you want to vary darkness of colours based on value or <a href="http://stackoverflow.com/questions/17321139/mapping-in-d3-ordinal-scales">vary the domain</a> based on the number of colours you want. Not a good fit.</p>

<p>I wanted to pick one of my values based on a linear value from my data set. My first thought was to make use of the ordinal scale function provided by d3. Something like this:</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">colour</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">ordinal</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">domain</span><span class="p">(</span><span class="nx">mySortedDataValues</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">colours</span><span class="p">);</span></code></pre></div>

<p>In doing this, I got something that *looked* a bit like it was working, but not the way I expected. In fact, the way an ordinal scale works is that it provides a 1-to-1 mapping of domain values to the range, rather than any kind of interpolation between them. In this case, it was expecting only 5 distinct data values (to match up against the colours) and for everything over and above that, it wrapped them round to the beginning of the domain again. The solution then is fairly simple once you’ve got your head around that.</p>

<p>What I did next, was to create a scale that gave the index of the colour we were going to be mapping to. This works well, because the indices are linear and d3 has the ability to do the dirty work in that respect.</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">colourIndex</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">data</span><span class="p">)])</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">colours</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;circle&quot;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">colours</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">colourIndex</span><span class="p">(</span><span class="nx">d</span><span class="p">))];</span>
   <span class="p">});</span></code></pre></div>

<p>Here we end up with an index ranging across all the indices of the colour array, and a colour appropriately selected from the palette as expected. You can see the resultant effect in the graph linked to below:</p>

<blockquote class="twitter-tweet" lang="en"><p>Working on some funky graphs for <a href="https://twitter.com/UseHourglass">@usehourglass</a>. This one shows how often you work certain times of the week: <a href="http://t.co/xRHE39HmTu">pic.twitter.com/xRHE39HmTu</a></p>&mdash; Ian Wootten (@iwootten) <a href="https://twitter.com/iwootten/statuses/441595966613774336">March 6, 2014</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>


<div class="entry_content">Tagged <a href="/tag/charting">charting</a>, <a href="/tag/d3">d3</a>,  | <a href="/2014/03/07/scaling-a-linear-domain-to-an-ordinal-range-with-d3/#disqus_thread">Leave a comment</a></div>
</div>



<div class="post">
<h1><a href="/2014/03/03/shipping-in-march">Shipping in March</a></h1>
<div class="author_meta">03 Mar 2014</div>
<p>This month, I’ve decided to take some time out to ship projects. </p>

<p>I have a huge list of projects accumulating I’d like to push out of the door, but as a father and freelancer I have lack of a certain commodity in able to achieve them. That would be time.</p>

<p>Currently I don’t have any work booked in for a while, so along with Viv, we’ve decided I should try and get some of these projects released. </p>

<p>That sounds easy, but I’m well aware from past experience it isn’t. I don’t want to work outside of working hours (9-5.30pm) as I know the impact it has on my family. My hope is by setting myself some achievable goals I can at least get some way to ticking off some checkboxes on this growing todo list. </p>

<p>Some of these projects are products I’ve not yet completed, projects I’ve released but need work or ideas that haven’t made it to the build stage yet. As a freelancer, I hope that some of them may even help out other people in a similar situation to me.</p>

<p>Over the coming month, I’m going to attempt to ship at least 4 projects out of the door. 1 a week for 4 weeks. I’ll be blogging about my progress here, and posting summaries of how it went at the end of each week. The end date of the 28th is also my birthday, so it would be great present to myself to have come some way to meeting my goal.</p>

<p>If you’re interested in receiving progress updates via email, signup here: <a href="http://eepurl.com/PxGe9">http://eepurl.com/PxGe9</a></p>

<div class="entry_content">Tagged <a href="/tag/projects">projects</a>,  | <a href="/2014/03/03/shipping-in-march/#disqus_thread">Leave a comment</a></div>
</div>



<div class="pagination">

  <span class="previous">Previous</span>

<span class="page_number ">Page: 1 of 28</span>

  <a href="/page/2" class="next">Next</a>

</div>

      <footer>
        <div class="footer-about">
          I'm a Web Developer  working at <a href="http://niftydigits.com">Nifty Digits</a> in Cardiff, UK. Here, I enjoy talking code - mostly javascript. I'm <a href="http://twitter.com/iwootten">@iwootten</a> on twitter.
        </div>
      </footer>
    </div>
   <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ianwootten'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
  </body>
</html>
