<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Ian Wootten - Web Developer, Cardiff</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/fonts/open-sans.css" />
        <link rel="stylesheet" href="/css/style.css" />
        <link rel="stylesheet" href="/css/syntax.css" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-263865-2', 'ianwootten.co.uk');
      ga('send', 'pageview');

    </script>
    </head>
    <body>


    <div class="container blog">
      <header>
        <nav>
        <ul class="nav">
          <li><a class="blog active" href="/">Blog</a></li>
          <li><a class="javascript" href="/category/javascript">Javascript</a></li>
          <li><a class="web-apps" href="/category/web-apps">Web Apps</a></li>
          <li><a class="about" href="/about">About</a></li>
          <li><a class="contact" href="/contact">Contact</a></li>
        </ul>
        </nav>
        <div class="clear"></div>
      </header>

          

	<div class="post">
	<h1><a href="/2012/09/04/recovering-images-from-sd-cards-with-photorec">Recovering Images from SD Cards with PhotoRec</a></h1>
<div class="author_meta">04 Sep 2012</div>
	<p>I had the horrible situation last Sunday following removing a number of pictures using an SD reader from my SD card that when I inserted it in my camera, it registered nothing upon it. My heart sunk, because this card is stuffed full of images of me and my family (along with my 1 year old son growing up) and I was unsure of which ones I’d actually backed up. After perusing the hidden files on the card, all I could discover was the files I’d most recently transferred from the card….great…</p>

<p>Partly this was my own fault – I’d already experienced problems with the reader in question when trying to write images for my <a href="http://raspberrypi.org">Raspberry Pi</a> and shouldn’t have used it for transferring images I care about. The card in question is a uber cheapo <a href="http://www.amazon.co.uk/Integral-USB-Single-Slot-Reader/dp/B000VY80AM/ref=sr_1_1?ie=UTF8&#038;qid=1346533453&#038;sr=8-1">Integral USB 2.0</a>. Despite what the amazon reviews say, steer well clear of it – this has been a pain from day one, with intermittent transfer problems which triggered this situation.</p>

<p>After a little more digging, I came across <a href="http://www.cgsecurity.org/wiki/PhotoRec">Photorec</a>, a commandline utility which seemed like it would hopefully help recover some of the images. I attempted to use it with my card reader, but given it’s credentials I’ve given above, found the scanning process would cut out and couldn’t get through the whole card. At this point the card was being reported empty….great…Given the way PhotoRec works, I understood it would still be possible to extract the images despite this. I decided to order another reader and hold fire until it had arrived – this time I opted for a <a href="http://www.amazon.co.uk/Kingston-Technology-Multi-Card-Reader/dp/B007PFQ0PC/">Kingston USB 3.0</a> (which I haven’t had any such problems with so far).</p>

<h2 id="the-solution">The Solution</h2>

<p>Here are the steps I followed after receiving my new sd reader to recover images from the card using PhotoRec. I’m listing them for anyone else who may have the same horrendous stomach wrenching problem I did last Sunday. It seems to have worked pretty well, with only 1 movie file coming out corrupted and about 500 images recovered.</p>

<p>Firstly, I wanted to take a copy of the card as it currently stood following my investigation. For this I used df, diskutil and ddrescue.</p>

<p>To determine where the card is currently mounted (look for the one that’s about the right size):</p>

<pre class="bash">df -h
</pre>

<p>To unmount the card so we can fiddle with it:</p>

<pre class="bash">sudo diskutil unmount /dev/disk1s1
</pre>

<p>To backup the card to a disk image on your macbook:</p>

<pre class="bash">sudo ddrescue /dev/disk1s1 ./sdbackup/image.img backuplog
</pre>

<p>Finally, using PhotoRec scan the disk image that was just created. My image was FAT formatted I scanned the whole thing rather than just unallocated blocks.</p>

<pre class="bash">sudo ./photorec ~/sdbackup/image.img
</pre>

<p>The final piece of this saga was to rename all the files PhotoRec created so they were in folders according to their exif data. My photos are all in folders like “2012_06_30″, so to have 500 files named “f0677440.jpg”, “f0688768.jpg” in a random PhotoRec directory would be pretty annoying. I had looked at setting up an automator task for this, but I ended up using <a href="http://www.petrosit.de/index.php/apps/12-pexiftool">PexifTool</a> for simplicities sake (I’m sure there are other alternatives). I believe if you go the Automator route, you may well have to install plugins in order to be able to extract exif data from files.</p>


	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>, <a href="/tag/mac">mac</a>, <a href="/tag/photorec">photorec</a>,  | <a href="/2012/09/04/recovering-images-from-sd-cards-with-photorec#disqus_thread">Leave a comment</a></div>
	</div>

    

	<div class="post">
	<h1><a href="/2006/10/16/bash-bash">Bash bash</a></h1>
<div class="author_meta">16 Oct 2006</div>
	<p>I was quite impressed with myself the other day that I’d actually managed to write a bash script within ubuntu which served a purpose. I wanted to be able to monitor the size of files within a particular directory, and report back their size when a change was observed.</p>

<p>I found a program called <a href="http://fileschanged.sourceforge.net">fileschanged</a>, which fulfilled half the problem, namely reporting back a file had changed, but I needed a greater level of detail than that. What it did allow me to do however was pass the filename as an argument (along with some other parameter) to another program. I duely spent an hour or so trying to figure out a script to take that filename and report back its filesize and the current time (which I assume is close enough to that which the file was changed). This is what it looks like: &lt;div class="wp_syntax"&gt;</p>
<table>
    <tr>
      <td class="code">
        <pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#!/bin/bash</span>
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-z</span> <span style="color: #ff0000;">"$1"</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-z</span> <span style="color: #ff0000;">"$2"</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
	<span style="color: #7a0874; font-weight: bold;">exit</span>
<span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #007800;">FN</span>=<span style="color: #007800;">$2</span>
<span style="color: #007800;">DATE</span>=$<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #c20cb9; font-weight: bold;">date</span> +<span style="color: #000000; font-weight: bold;">%</span>s<span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #007800;">FILESIZE</span>=$<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #c20cb9; font-weight: bold;">stat</span> -c<span style="color: #000000; font-weight: bold;">%</span>s <span style="color: #ff0000;">"<span style="color: #007800;">$FN</span>"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #ff0000;">"<span style="color: #007800;">$DATE</span>,<span style="color: #007800;">$FN</span>,<span style="color: #007800;">$FILESIZE</span>"</span></pre>
      </td>
    </tr>
  </table>
<p>&lt;/div&gt;</p>


	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>,  | <a href="/2006/10/16/bash-bash#disqus_thread">Leave a comment</a></div>
	</div>

    

	<div class="post">
	<h1><a href="/2006/09/06/xgl-compiz-on-dapper-64-too-much-to-ask">XGL, Compiz on Dapper 64 &#8211; Too much to ask?</a></h1>
<div class="author_meta">06 Sep 2006</div>
	<p>I spent a large amount of time last week, after realising that I could very easy install compiz and XGL on my machine at uni, trying to install it upon my home machine. As its 64 bit, and owing to previous problems I’d experienced installing 64 bit applications (like linux for instance), I spent the best part of 2 days attempting to install both, before caving and completely giving up.I got to the stage where XGL is installed properly and seems to work ok, but the compiz gnome window manager isn’t working properly, meaning I have no borders to any panes I create.It’s not like I need a whizzy 4 sided cube spinning around, but I thought it might be fun…</p>

	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>,  | <a href="/2006/09/06/xgl-compiz-on-dapper-64-too-much-to-ask#disqus_thread">Leave a comment</a></div>
	</div>

    

	<div class="post">
	<h1><a href="/2006/08/19/slugs-talking-nicely">Slug&#8217;s Talking Nicely</a></h1>
<div class="author_meta">19 Aug 2006</div>
	<p>I’ve had a couple of problems getting my slug working nice under ubuntu. Firstly, although it is recognised by default and I can connect and browse via samba, when I actually came to playing my media, everything got screwed up, with Amarok trying to launch kmail…… I could copy files to ubuntu and play them properly from there, but straight off of the slug was a no go.I found the solution was to mount it under ubuntu using the command:<code>sudo mount -t smbfs //NAS/DISK 1 /media/slug -o username=user,password=pass</code>Where user and pass are your username and password for the slug respectively and the backslash indicates a space. This poses another problem however, that you don’t want to have to fire up a terminal everytime you want to listen to media, instead its better to get it automounted at startup using an entry in /etc/fstab:<code>sudo gedit /etc/fstab</code>and then add a line:<code>//NAS/DISK 401 /media/slug	smbfs	username=user,password=pass,rw&lt;br /&gt;
</code></p>

<p>Again supplimenting user and pass with your username and password. The  40 indicates a space in the name of the share which is on the NAS, which annoyingly took me a large amount of time to figure out!</p>

	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>,  | <a href="/2006/08/19/slugs-talking-nicely#disqus_thread">Leave a comment</a></div>
	</div>

    

	<div class="post">
	<h1><a href="/2006/08/12/more-ubuntu-ati-9600-and-sblive">More Ubuntu? &#8211; ATI 9600 and SBLive</a></h1>
<div class="author_meta">12 Aug 2006</div>
	<p>Another post about ubuntu? Where will it end?I was fairly excited from thursday evenings antics of getting things working on my machine at home, I thought I’d give it a try with my dev machine at uni. My graphics card, a 9600 (yes ATI, I know!) had been screwed since the day I’d put on Dapper, and to be honest, as I’m not using it that much for GL stuff, I wasn’t really bothered about it. After installing the ATI drivers, them not working and reinstalling the fglrx xorg drivers, I managed to get it working nicely within about 30 mins. <a href="http://wiki.cchtml.com/index.php/Ubuntu_Installation_Guide" title="Unofficial ATI Linux Driver Wiki">This wiki page</a> may help if you’re experiencing similar problems. In my case, my driver was loading, but I was having a problem with libdri.a menaing 3d acceleration got switched off. Anyway, glxgears is now shuvving out a good 3000+ fps so I’m happy enough with that.Aha, I thought, I’ll give the soundcard a bash – a 6 year old SBLive Platinum complete with live drive. Although this (with some tweaking in alsamixer) give outputs on the pci card, the front bay wasn’t getting any output to the headphone socket. I tried to install and compile the latest emu10k drivers from <a href="http://www.alsa-project.org/" title="Advanced Linux Sound Architecture">alsa</a>, but then everything got screwed up and no drivers were loading. I removed them and reinstalled what I had before. I carried on with my troubles, inspecting my front bay for any connection problems, notcing one fairly major one…..having the headphones in the mic input – doh! I’d do well to check the obvious things first in the future.</p>


	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>,  | <a href="/2006/08/12/more-ubuntu-ati-9600-and-sblive#disqus_thread">Leave a comment</a></div>
	</div>

    

	<div class="post">
	<h1><a href="/2006/08/10/did-i-speak-too-soon">Did I speak too soon?</a></h1>
<div class="author_meta">10 Aug 2006</div>
	<p>It seems I may have spoken too soon about my linux joys with ubuntu. After performing a dist-upgrade on my previous beta version of Dapper, I discovered I’d have to go through the same problems of downloading kernel source and linux header packages for my new kernel version.I also discovered after doing this that actually there were further problems on booting Dapper straight up. Apparently the pointers to drives get screwed up somewhere in the process. Although I could boot into X using just the safety mode and booting from there, this wasn’t ideal and I still wanted my lovely little 64 bit install to be working nicely. I dicovered that adding the line ide=nodma to the line of the reference in grub solved the problem.So I’m in, great you might think, but oh no – lets try amarok on for size too… Amarok (A shiny linux media player I discoved) wasn’t playing any of my mp3′s at all, just whizzing through the lot of them. A short search revealed that in using the xine engine, xine needed further codecs to be installed to get sound out too. You’d think that a dependency would be put in place here to sort this out by default. One nice feature I like is the inbuilt submission to last.fm, a great idea in my book – I use it all the time.Anyway, *now *my Ubuntu is being nice. Oh no, have I just jinxed it?</p>

	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>,  | <a href="/2006/08/10/did-i-speak-too-soon#disqus_thread">Leave a comment</a></div>
	</div>

    

	<div class="post">
	<h1><a href="/2006/08/07/ubuntu-working">Ubuntu Working</a></h1>
<div class="author_meta">07 Aug 2006</div>
	<p>FInally, after a grand total of 10 months, I have a 64bit version of Ubuntu Linux working upon my home machine.This is great news, not only does it mean that I have a wonderful OS to try out for size, but that I can easily convert my subversion server code and latex source to my machine.As I’ve never mentioned it before, I’ll detail what the problem was here. First up, the graphics card didn’t have drivers which were working which meant that my X800 was pretty pathetic to be quite honest with you. There was a fairly simple solution through apt, which would have been nice if………………the network card on my A8N-VM CSM was working properly, which it wasn’t, due to use of an NFORCE chipset. A build of some drivers were neccessary, which required adding a load of packages (simple if apt were working!).Anyway, several days of man hours later, and this ubuntu thing works wonderfully. If you’re having similar troubles with this board, its probably best to use <a href="https://help.ubuntu.com/community/NvNetInstallation" title="Ubuntu NVNet installation">this page</a> for guidance.</p>


	<div class="entry_content">Tagged <a href="/tag/linux">linux</a>,  | <a href="/2006/08/07/ubuntu-working#disqus_thread">Leave a comment</a></div>
	</div>

    


      <div class="pagination">
        
          <span class="previous">Previous</span>
        
        <span class="page_number ">Page: 1 of 1</span>
        
          <span class="next ">Next</span>
        
      </div>

      <footer>
        <div class="footer-about">
          I'm a Web Developer  working at <a href="http://niftydigits.com">Nifty Digits</a> in Cardiff, UK. Here, I enjoy talking code - mostly javascript. I'm <a href="http://twitter.com/iwootten">@iwootten</a> on twitter.
        </div>
      </footer>
    </div>
   <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ianwootten'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
  </body>
</html>
